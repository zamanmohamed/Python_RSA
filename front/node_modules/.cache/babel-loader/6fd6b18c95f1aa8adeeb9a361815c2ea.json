{"ast":null,"code":"var _ = require('../utils')._;\n\nfunction formatParse(format) {\n  format = format.split('-');\n  var keyType = 'private';\n  var keyOpt = {\n    type: 'default'\n  };\n\n  for (var i = 1; i < format.length; i++) {\n    if (format[i]) {\n      switch (format[i]) {\n        case 'public':\n          keyType = format[i];\n          break;\n\n        case 'private':\n          keyType = format[i];\n          break;\n\n        case 'pem':\n          keyOpt.type = format[i];\n          break;\n\n        case 'der':\n          keyOpt.type = format[i];\n          break;\n      }\n    }\n  }\n\n  return {\n    scheme: format[0],\n    keyType: keyType,\n    keyOpt: keyOpt\n  };\n}\n\nmodule.exports = {\n  pkcs1: require('./pkcs1'),\n  pkcs8: require('./pkcs8'),\n  components: require('./components'),\n  openssh: require('./openssh'),\n  isPrivateExport: function (format) {\n    return module.exports[format] && typeof module.exports[format].privateExport === 'function';\n  },\n  isPrivateImport: function (format) {\n    return module.exports[format] && typeof module.exports[format].privateImport === 'function';\n  },\n  isPublicExport: function (format) {\n    return module.exports[format] && typeof module.exports[format].publicExport === 'function';\n  },\n  isPublicImport: function (format) {\n    return module.exports[format] && typeof module.exports[format].publicImport === 'function';\n  },\n  detectAndImport: function (key, data, format) {\n    if (format === undefined) {\n      for (var scheme in module.exports) {\n        if (typeof module.exports[scheme].autoImport === 'function' && module.exports[scheme].autoImport(key, data)) {\n          return true;\n        }\n      }\n    } else if (format) {\n      var fmt = formatParse(format);\n\n      if (module.exports[fmt.scheme]) {\n        if (fmt.keyType === 'private') {\n          module.exports[fmt.scheme].privateImport(key, data, fmt.keyOpt);\n        } else {\n          module.exports[fmt.scheme].publicImport(key, data, fmt.keyOpt);\n        }\n      } else {\n        throw Error('Unsupported key format');\n      }\n    }\n\n    return false;\n  },\n  detectAndExport: function (key, format) {\n    if (format) {\n      var fmt = formatParse(format);\n\n      if (module.exports[fmt.scheme]) {\n        if (fmt.keyType === 'private') {\n          if (!key.isPrivate()) {\n            throw Error(\"This is not private key\");\n          }\n\n          return module.exports[fmt.scheme].privateExport(key, fmt.keyOpt);\n        } else {\n          if (!key.isPublic()) {\n            throw Error(\"This is not public key\");\n          }\n\n          return module.exports[fmt.scheme].publicExport(key, fmt.keyOpt);\n        }\n      } else {\n        throw Error('Unsupported key format');\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/Zaman/zaman/RSA/front/node_modules/node-rsa/src/formats/formats.js"],"names":["_","require","formatParse","format","split","keyType","keyOpt","type","i","length","scheme","module","exports","pkcs1","pkcs8","components","openssh","isPrivateExport","privateExport","isPrivateImport","privateImport","isPublicExport","publicExport","isPublicImport","publicImport","detectAndImport","key","data","undefined","autoImport","fmt","Error","detectAndExport","isPrivate","isPublic"],"mappings":"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","sourcesContent":["var _ = require('../utils')._;\n\nfunction formatParse(format) {\n    format = format.split('-');\n    var keyType = 'private';\n    var keyOpt = {type: 'default'};\n\n    for (var i = 1; i < format.length; i++) {\n        if (format[i]) {\n            switch (format[i]) {\n                case 'public':\n                    keyType = format[i];\n                    break;\n                case 'private':\n                    keyType = format[i];\n                    break;\n                case 'pem':\n                    keyOpt.type = format[i];\n                    break;\n                case 'der':\n                    keyOpt.type = format[i];\n                    break;\n            }\n        }\n    }\n\n    return {scheme: format[0], keyType: keyType, keyOpt: keyOpt};\n}\n\nmodule.exports = {\n    pkcs1: require('./pkcs1'),\n    pkcs8: require('./pkcs8'),\n    components: require('./components'),\n    openssh: require('./openssh'),\n\n    isPrivateExport: function (format) {\n        return module.exports[format] && typeof module.exports[format].privateExport === 'function';\n    },\n\n    isPrivateImport: function (format) {\n        return module.exports[format] && typeof module.exports[format].privateImport === 'function';\n    },\n\n    isPublicExport: function (format) {\n        return module.exports[format] && typeof module.exports[format].publicExport === 'function';\n    },\n\n    isPublicImport: function (format) {\n        return module.exports[format] && typeof module.exports[format].publicImport === 'function';\n    },\n\n    detectAndImport: function (key, data, format) {\n        if (format === undefined) {\n            for (var scheme in module.exports) {\n                if (typeof module.exports[scheme].autoImport === 'function' && module.exports[scheme].autoImport(key, data)) {\n                    return true;\n                }\n            }\n        } else if (format) {\n            var fmt = formatParse(format);\n\n            if (module.exports[fmt.scheme]) {\n                if (fmt.keyType === 'private') {\n                    module.exports[fmt.scheme].privateImport(key, data, fmt.keyOpt);\n                } else {\n                    module.exports[fmt.scheme].publicImport(key, data, fmt.keyOpt);\n                }\n            } else {\n                throw Error('Unsupported key format');\n            }\n        }\n\n        return false;\n    },\n\n    detectAndExport: function (key, format) {\n        if (format) {\n            var fmt = formatParse(format);\n\n            if (module.exports[fmt.scheme]) {\n                if (fmt.keyType === 'private') {\n                    if (!key.isPrivate()) {\n                        throw Error(\"This is not private key\");\n                    }\n                    return module.exports[fmt.scheme].privateExport(key, fmt.keyOpt);\n                } else {\n                    if (!key.isPublic()) {\n                        throw Error(\"This is not public key\");\n                    }\n                    return module.exports[fmt.scheme].publicExport(key, fmt.keyOpt);\n                }\n            } else {\n                throw Error('Unsupported key format');\n            }\n        }\n    }\n};"]},"metadata":{},"sourceType":"script"}